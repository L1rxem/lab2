# Лабораторная работа 2

## Задание

Разработать и реализовать клиент-серверную информационную систему, реализующую механизм CRUD
Интерфейс системы представляет собой веб-страницу с лентой заметок, отсортированных в обратном хронологическом порядке и форму добавления новой заметки.

Возможности пользователей:
- добавление текстовых заметок в общую ленту
- реагирование на чужие заметки (лайки)
- добавление комментариев к чужим заметкам

## Ход работы

### Пользовательский сценарий работы 
Посетитель попадает на стартовую страницу **page.php**. Он в состоянии вводить любые текстовые сообщения. Если ввод выполнен корректно и проходит проверки, то его сообщение будет выводится в ленту. 
Все пользователи могут стоавить реакции на тредыы, а именно реализована функция проставления лайка и дизлайка и писать любые комментарии. Дабы иметь возможность оставить комментарий, необходимо в поле под постом написать что-то и нажать кнопку **Оставить комментарий**.

![process scheme](/2.1.png "concept scheme")

### Структура базы данных

Для хранения данных форума используется база данных MySQL.

База данных содержит 2 таблицы : `posts` и `comments`

 Таблица `posts`
| Название | Тип | NULL | Дополнительно | Описание |
| :------: | :------: | :------: | :------: | :------: |
| **id** | INT  | NO | AUTO_INCREMENT | Автоматический идентификатор поста |
| **time** | TEXT | NO | | Дата создания поста |
| **msg** | INT | NO | | Текст поста |
| **likes** | INT | NO | | Количество лайков |
| **dislikes** | INT | NO | | Количество дизлайков |

Таблица `comments`
| Название | Тип | NULL | Дополнительно | Описание |
| :------: | :------: | :------: | :------: | :------: |
| **id** | INT  | NO | AUTO_INCREMENT | Идентификатор комментария |
| **id_msg** | INT  | NO | | Идентификатор поста |
| **comm_txt** | TEXT | NO | | Текст комментария |
| **time** | DATETIME | NO | | Дата написания комментария |

### Значимые фрагменты кода

Добавление комментария
```
<?php

$db = mysqli_connect ("localhost","root","","forum");

if(isset($_GET['comment']))
{
    if(isset($_GET['com']))
    {
        $id_msg = $_GET['com'];
        $comment = $_GET['comment'];
        $id = 0;
        $sql = mysqli_query($db, "INSERT INTO comments (id, id_msg, msg, time) VALUES ('$id', '$id_msg', '$comment', NOW())");
    }
}

header('Location: index.php');

exit();

?>
```
Добавление реакции (Лайк/Дизлайк)
```
<?php

$db = mysqli_connect ("localhost","root","","forum");

if(isset($_POST['like']))
{
    $id_like = $_POST['like'];
    $sql = mysqli_query($db, 'UPDATE posts SET likes = likes + 1 WHERE id = '.$id_like.'');
    header('Location: index.php');
    exit();
}

if(isset($_POST['dislike']))
{
    $id_dislike = $_POST['dislike'];
    echo $_POST['dislike'];
    $sql = mysqli_query($db, 'UPDATE posts SET dislikes = dislikes + 1 WHERE id = '.$id_dislike.'');
    echo $id_dislike;
}

header('Location: index.php');

exit();

?>
```
